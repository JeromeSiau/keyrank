<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>keyrank - Icon Generator</title>
  <style>
    :root {
      --bg-dark: #09090b;
      --bg-card: #18181b;
      --border: #27272a;
      --text-primary: #fafafa;
      --text-muted: #71717a;
      --accent: #6366f1;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--bg-dark);
      color: var(--text-primary);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      min-height: 100vh;
      padding: 40px;
    }

    h1 {
      font-size: 28px;
      margin-bottom: 8px;
    }

    .subtitle {
      color: var(--text-muted);
      margin-bottom: 40px;
    }

    .section {
      margin-bottom: 48px;
    }

    .section-title {
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }

    .icons-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
      align-items: flex-end;
    }

    .icon-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }

    .icon-preview {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .icon-label {
      font-size: 11px;
      color: var(--text-muted);
      text-align: center;
    }

    .icon-label strong {
      display: block;
      color: var(--text-primary);
      font-size: 13px;
      margin-bottom: 2px;
    }

    .download-btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 8px;
      transition: opacity 0.2s;
    }

    .download-btn:hover {
      opacity: 0.9;
    }

    .download-all {
      background: linear-gradient(135deg, #4f46e5, #818cf8);
      color: white;
      border: none;
      padding: 16px 32px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 20px;
    }

    #canvas {
      display: none;
    }

    .instructions {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 40px;
    }

    .instructions h3 {
      font-size: 14px;
      margin-bottom: 12px;
    }

    .instructions ol {
      color: var(--text-muted);
      font-size: 14px;
      padding-left: 20px;
    }

    .instructions li {
      margin-bottom: 8px;
    }

    .instructions code {
      background: var(--bg-dark);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <h1>keyrank Icon Generator</h1>
  <p class="subtitle">Logo 1B - Contained Geometric Ascent</p>

  <div class="instructions">
    <h3>Instructions</h3>
    <ol>
      <li>Click "Download All Icons" to get a ZIP with all icons</li>
      <li>Copy files from <code>flutter-assets/</code> to <code>app/assets/images/</code></li>
      <li>Run <code>flutter pub get</code> then <code>dart run flutter_launcher_icons</code></li>
      <li>Run <code>dart run flutter_native_splash:create</code></li>
      <li>Or manually replace icons in platform folders (ios/, android/, etc.)</li>
    </ol>
  </div>

  <button class="download-all" onclick="downloadAllIcons()">Download All Icons</button>

  <!-- Flutter Assets -->
  <section class="section">
    <h2 class="section-title">Flutter Assets (for flutter_launcher_icons)</h2>
    <div class="icons-grid" id="flutter-icons"></div>
  </section>

  <!-- iOS Icons -->
  <section class="section">
    <h2 class="section-title">iOS Icons</h2>
    <div class="icons-grid" id="ios-icons"></div>
  </section>

  <!-- Android Icons -->
  <section class="section">
    <h2 class="section-title">Android Icons</h2>
    <div class="icons-grid" id="android-icons"></div>
  </section>

  <!-- macOS Icons -->
  <section class="section">
    <h2 class="section-title">macOS Icons</h2>
    <div class="icons-grid" id="macos-icons"></div>
  </section>

  <!-- Web Icons -->
  <section class="section">
    <h2 class="section-title">Web Icons</h2>
    <div class="icons-grid" id="web-icons"></div>
  </section>

  <!-- Windows Icons -->
  <section class="section">
    <h2 class="section-title">Windows Icons</h2>
    <div class="icons-grid" id="windows-icons"></div>
  </section>

  <canvas id="canvas"></canvas>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script>
    // Icon sizes for each platform
    const iconSizes = {
      flutter: [
        { name: 'app_icon.png', size: 1024 },
        { name: 'app_icon_foreground.png', size: 1024, foregroundOnly: true },
        { name: 'splash_logo.png', size: 512, splash: true },
        { name: 'splash_icon.png', size: 288, splash: true },
      ],
      ios: [
        { name: 'Icon-App-20x20@1x.png', size: 20 },
        { name: 'Icon-App-20x20@2x.png', size: 40 },
        { name: 'Icon-App-20x20@3x.png', size: 60 },
        { name: 'Icon-App-29x29@1x.png', size: 29 },
        { name: 'Icon-App-29x29@2x.png', size: 58 },
        { name: 'Icon-App-29x29@3x.png', size: 87 },
        { name: 'Icon-App-40x40@1x.png', size: 40 },
        { name: 'Icon-App-40x40@2x.png', size: 80 },
        { name: 'Icon-App-40x40@3x.png', size: 120 },
        { name: 'Icon-App-60x60@2x.png', size: 120 },
        { name: 'Icon-App-60x60@3x.png', size: 180 },
        { name: 'Icon-App-76x76@1x.png', size: 76 },
        { name: 'Icon-App-76x76@2x.png', size: 152 },
        { name: 'Icon-App-83.5x83.5@2x.png', size: 167 },
        { name: 'Icon-App-1024x1024@1x.png', size: 1024 },
      ],
      android: [
        { name: 'mipmap-mdpi/ic_launcher.png', size: 48 },
        { name: 'mipmap-hdpi/ic_launcher.png', size: 72 },
        { name: 'mipmap-xhdpi/ic_launcher.png', size: 96 },
        { name: 'mipmap-xxhdpi/ic_launcher.png', size: 144 },
        { name: 'mipmap-xxxhdpi/ic_launcher.png', size: 192 },
      ],
      macos: [
        { name: 'app_icon_16.png', size: 16 },
        { name: 'app_icon_32.png', size: 32 },
        { name: 'app_icon_64.png', size: 64 },
        { name: 'app_icon_128.png', size: 128 },
        { name: 'app_icon_256.png', size: 256 },
        { name: 'app_icon_512.png', size: 512 },
        { name: 'app_icon_1024.png', size: 1024 },
      ],
      web: [
        { name: 'favicon.png', size: 32 },
        { name: 'Icon-192.png', size: 192 },
        { name: 'Icon-512.png', size: 512 },
        { name: 'Icon-maskable-192.png', size: 192, maskable: true },
        { name: 'Icon-maskable-512.png', size: 512, maskable: true },
      ],
      windows: [
        { name: 'app_icon_256.png', size: 256 },
      ],
    };

    // Helper to draw a filled rounded rectangle
    function fillRoundRect(ctx, x, y, w, h, r, color) {
      ctx.fillStyle = color;
      ctx.beginPath();
      if (ctx.roundRect) {
        ctx.roundRect(x, y, w, h, r);
      } else {
        // Fallback for older browsers
        ctx.moveTo(x + r, y);
        ctx.arcTo(x + w, y, x + w, y + h, r);
        ctx.arcTo(x + w, y + h, x, y + h, r);
        ctx.arcTo(x, y + h, x, y, r);
        ctx.arcTo(x, y, x + w, y, r);
        ctx.closePath();
      }
      ctx.fill();
    }

    // Helper to draw a stroked rounded rectangle
    function strokeRoundRect(ctx, x, y, w, h, r, color, lineWidth) {
      ctx.strokeStyle = color;
      ctx.lineWidth = lineWidth;
      ctx.beginPath();
      if (ctx.roundRect) {
        ctx.roundRect(x, y, w, h, r);
      } else {
        ctx.moveTo(x + r, y);
        ctx.arcTo(x + w, y, x + w, y + h, r);
        ctx.arcTo(x + w, y + h, x, y + h, r);
        ctx.arcTo(x, y + h, x, y, r);
        ctx.arcTo(x, y, x + w, y, r);
        ctx.closePath();
      }
      ctx.stroke();
    }

    // Draw the icon on canvas
    function drawIcon(ctx, size, options = {}) {
      const { maskable = false, foregroundOnly = false, splash = false } = options;
      const scale = size / 56;

      ctx.save();
      ctx.scale(scale, scale);

      if (maskable) {
        // Maskable icons need more padding and solid background
        ctx.fillStyle = '#18181b';
        ctx.fillRect(0, 0, 56, 56);
        ctx.translate(8, 8);
        ctx.scale(0.7, 0.7);
      }

      if (splash) {
        // Splash logo: centered icon on dark background
        ctx.fillStyle = '#09090b';
        ctx.fillRect(0, 0, 56, 56);
        ctx.translate(8, 8);
        ctx.scale(0.7, 0.7);
      }

      if (!foregroundOnly) {
        // Background rounded square
        fillRoundRect(ctx, 2, 2, 52, 52, 14, '#18181b');
        strokeRoundRect(ctx, 2, 2, 52, 52, 14, '#27272a', 1);
      }

      // Bar 1 (smallest) - dark indigo
      fillRoundRect(ctx, 10, 34, 10, 14, 2, '#4f46e5');

      // Bar 2 (medium) - medium indigo
      fillRoundRect(ctx, 23, 26, 10, 22, 2, '#6366f1');

      // Bar 3 (tallest) - light indigo
      fillRoundRect(ctx, 36, 16, 10, 32, 2, '#818cf8');

      // Arrow vertical line
      ctx.beginPath();
      ctx.moveTo(46, 8);
      ctx.lineTo(46, 14);
      ctx.strokeStyle = '#a5b4fc';
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.stroke();

      // Arrow head
      ctx.beginPath();
      ctx.moveTo(43, 11);
      ctx.lineTo(46, 8);
      ctx.lineTo(49, 11);
      ctx.strokeStyle = '#a5b4fc';
      ctx.lineWidth = 2;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.stroke();

      ctx.restore();
    }

    // Generate icon and return data URL
    function generateIcon(size, options = {}) {
      const canvas = document.getElementById('canvas');
      canvas.width = size;
      canvas.height = size;
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, size, size);
      drawIcon(ctx, size, options);
      return canvas.toDataURL('image/png');
    }

    // Download single icon
    function downloadIcon(name, size, options = {}) {
      const dataUrl = generateIcon(size, options);
      const link = document.createElement('a');
      link.download = name.split('/').pop();
      link.href = dataUrl;
      link.click();
    }

    // Download all icons as ZIP
    async function downloadAllIcons() {
      const zip = new JSZip();

      // Flutter assets
      const flutterFolder = zip.folder('flutter-assets');
      for (const icon of iconSizes.flutter) {
        const dataUrl = generateIcon(icon.size, { foregroundOnly: icon.foregroundOnly, splash: icon.splash });
        const base64 = dataUrl.split(',')[1];
        flutterFolder.file(icon.name, base64, { base64: true });
      }

      // iOS
      const iosFolder = zip.folder('ios');
      for (const icon of iconSizes.ios) {
        const dataUrl = generateIcon(icon.size, { maskable: icon.maskable });
        const base64 = dataUrl.split(',')[1];
        iosFolder.file(icon.name, base64, { base64: true });
      }

      // Android
      const androidFolder = zip.folder('android');
      for (const icon of iconSizes.android) {
        const dataUrl = generateIcon(icon.size, { maskable: icon.maskable });
        const base64 = dataUrl.split(',')[1];
        const parts = icon.name.split('/');
        if (parts.length > 1) {
          const subFolder = androidFolder.folder(parts[0]);
          subFolder.file(parts[1], base64, { base64: true });
        } else {
          androidFolder.file(icon.name, base64, { base64: true });
        }
      }

      // macOS
      const macosFolder = zip.folder('macos');
      for (const icon of iconSizes.macos) {
        const dataUrl = generateIcon(icon.size, { maskable: icon.maskable });
        const base64 = dataUrl.split(',')[1];
        macosFolder.file(icon.name, base64, { base64: true });
      }

      // Web
      const webFolder = zip.folder('web');
      for (const icon of iconSizes.web) {
        const dataUrl = generateIcon(icon.size, { maskable: icon.maskable });
        const base64 = dataUrl.split(',')[1];
        webFolder.file(icon.name, base64, { base64: true });
      }

      // Windows
      const windowsFolder = zip.folder('windows');
      for (const icon of iconSizes.windows) {
        const dataUrl = generateIcon(icon.size, { maskable: icon.maskable });
        const base64 = dataUrl.split(',')[1];
        windowsFolder.file(icon.name, base64, { base64: true });
      }

      const content = await zip.generateAsync({ type: 'blob' });
      const link = document.createElement('a');
      link.download = 'keyrank-icons.zip';
      link.href = URL.createObjectURL(content);
      link.click();
    }

    // Render preview icons
    function renderPreviews() {
      for (const [platform, sizes] of Object.entries(iconSizes)) {
        const container = document.getElementById(`${platform}-icons`);
        if (!container) continue;

        // Show only a few representative sizes
        const previewSizes = sizes.filter((s, i) => {
          if (platform === 'ios') return [0, 4, 10, 14].includes(i);
          if (platform === 'android') return [0, 2, 4].includes(i);
          if (platform === 'flutter') return true; // Show all flutter assets
          return i < 4;
        });

        for (const icon of previewSizes) {
          const item = document.createElement('div');
          item.className = 'icon-item';

          const preview = document.createElement('div');
          preview.className = 'icon-preview';

          const canvas = document.createElement('canvas');
          const displaySize = Math.min(icon.size, 128);
          canvas.width = displaySize;
          canvas.height = displaySize;
          canvas.style.width = `${displaySize}px`;
          canvas.style.height = `${displaySize}px`;
          const ctx = canvas.getContext('2d');
          drawIcon(ctx, displaySize, { maskable: icon.maskable, foregroundOnly: icon.foregroundOnly, splash: icon.splash });

          preview.appendChild(canvas);

          const label = document.createElement('div');
          label.className = 'icon-label';
          label.innerHTML = `<strong>${icon.size}x${icon.size}</strong>${icon.name.split('/').pop()}`;

          const btn = document.createElement('button');
          btn.className = 'download-btn';
          btn.textContent = 'Download';
          btn.onclick = () => downloadIcon(icon.name, icon.size, { maskable: icon.maskable, foregroundOnly: icon.foregroundOnly, splash: icon.splash });

          item.appendChild(preview);
          item.appendChild(label);
          item.appendChild(btn);
          container.appendChild(item);
        }
      }
    }

    // Initialize
    renderPreviews();
  </script>
</body>
</html>
