# Design i18n â€” Internationalisation de Keyrank

## Objectif

Rendre l'application multilingue avec une langue cohÃ©rente partout. Actuellement les textes sont hardcodÃ©s avec un mÃ©lange incohÃ©rent franÃ§ais/anglais.

## Langues supportÃ©es

| Code | Langue | MarchÃ© |
|------|--------|--------|
| en | English | US, UK, Australie (fallback par dÃ©faut) |
| fr | FranÃ§ais | France, Belgique, Suisse, Canada |
| de | Deutsch | Allemagne, Autriche, Suisse |
| es | EspaÃ±ol | Espagne, AmÃ©rique Latine |
| pt | PortuguÃªs | BrÃ©sil, Portugal |
| it | Italiano | Italie |
| ja | æ—¥æœ¬èªž | Japon |
| ko | í•œêµ­ì–´ | CorÃ©e du Sud |
| zh | ä¸­æ–‡ | Chine |
| tr | TÃ¼rkÃ§e | Turquie |

## Architecture

### Structure des fichiers

```
app/
â”œâ”€â”€ l10n.yaml                    # Config flutter gen-l10n
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ l10n/
â”‚   â”‚   â”œâ”€â”€ app_en.arb          # Anglais (source de rÃ©fÃ©rence)
â”‚   â”‚   â”œâ”€â”€ app_fr.arb          # FranÃ§ais
â”‚   â”‚   â”œâ”€â”€ app_de.arb          # Allemand
â”‚   â”‚   â”œâ”€â”€ app_es.arb          # Espagnol
â”‚   â”‚   â”œâ”€â”€ app_pt.arb          # Portugais
â”‚   â”‚   â”œâ”€â”€ app_it.arb          # Italien
â”‚   â”‚   â”œâ”€â”€ app_ja.arb          # Japonais
â”‚   â”‚   â”œâ”€â”€ app_ko.arb          # CorÃ©en
â”‚   â”‚   â”œâ”€â”€ app_zh.arb          # Chinois simplifiÃ©
â”‚   â”‚   â””â”€â”€ app_tr.arb          # Turc
â”‚   â””â”€â”€ core/
â”‚       â””â”€â”€ providers/
â”‚           â””â”€â”€ locale_provider.dart  # Gestion de la locale (Riverpod)
```

### Approche technique

- **Standard Flutter officiel** : `flutter_localizations` + fichiers ARB
- **GÃ©nÃ©ration de code** : `flutter gen-l10n` gÃ©nÃ¨re `AppLocalizations`
- **Typesafe** : `AppLocalizations.of(context)!.welcomeBack`
- **Traductions** : GÃ©nÃ©rÃ©es via IA pour les 10 langues

## Convention de nommage des clÃ©s

```
[screen]_[element]_[description]
```

### Exemples

```json
{
  "auth_welcomeBack": "Welcome back",
  "auth_signInButton": "Sign in",
  "auth_emailLabel": "Email",
  "auth_passwordRequired": "Please enter your password",
  "dashboard_title": "Dashboard",
  "dashboard_addAppButton": "Add App",
  "settings_appearanceSection": "Appearance",
  "settings_logoutButton": "Log out",
  "common_retry": "Retry",
  "common_error": "Error",
  "common_loading": "Loading..."
}
```

### Strings avec paramÃ¨tres

```json
{
  "dashboard_appsTracked": "{count} Apps Tracked",
  "@dashboard_appsTracked": {
    "placeholders": {
      "count": { "type": "int" }
    }
  }
}
```

### Pluriels

```json
{
  "keywords_count": "{count, plural, =0{No keywords} =1{1 keyword} other{{count} keywords}}"
}
```

## Gestion de la locale

### Flow au dÃ©marrage

1. App dÃ©marre â†’ charge prÃ©fÃ©rence utilisateur depuis API backend
2. Si prÃ©fÃ©rence = "system" ou absente â†’ utilise `Platform.localeName`
3. Si locale non supportÃ©e â†’ fallback `en`
4. Riverpod propage la locale â†’ `MaterialApp` rebuild

### Persistance

- **Stockage** : Base de donnÃ©es backend (prÃ©fÃ©rence utilisateur)
- **Endpoint** : `PUT /user/preferences` avec `{ "locale": "fr" }`
- **Valeurs** : `"system"`, `"en"`, `"fr"`, `"de"`, `"es"`, `"pt"`, `"it"`, `"ja"`, `"ko"`, `"zh"`, `"tr"`

### LocaleProvider (Riverpod)

```dart
final localeProvider = StateNotifierProvider<LocaleNotifier, Locale?>((ref) {
  return LocaleNotifier(ref);
});

class LocaleNotifier extends StateNotifier<Locale?> {
  final Ref _ref;
  String _preference = 'system';

  LocaleNotifier(this._ref) : super(null);

  Future<void> loadFromApi() async {
    // Charge depuis l'API user/preferences
    // Si "system" â†’ resolve depuis Platform.localeName
    // Sinon â†’ utilise la locale spÃ©cifiÃ©e
  }

  Future<void> setLocale(String localeCode) async {
    // Sauvegarde en API
    // Met Ã  jour l'Ã©tat local
  }
}
```

## UI Settings

### SÃ©lecteur de langue

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Settings                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸŒ Language                     â”‚
â”‚    â””â”€ English (System) â–¼        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸŽ¨ Appearance                   â”‚
â”‚    â””â”€ Theme: Dark â–¼             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ‘¤ Account                      â”‚
â”‚    â””â”€ Member since ...          â”‚
â”‚    â””â”€ Log out                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Options dropdown

- System (suit la langue du systÃ¨me)
- English
- FranÃ§ais
- Deutsch
- EspaÃ±ol
- PortuguÃªs
- Italiano
- æ—¥æœ¬èªž
- í•œêµ­ì–´
- ä¸­æ–‡
- TÃ¼rkÃ§e

## IntÃ©gration MaterialApp

```dart
MaterialApp(
  localizationsDelegates: [
    AppLocalizations.delegate,
    GlobalMaterialLocalizations.delegate,
    GlobalWidgetsLocalizations.delegate,
    GlobalCupertinoLocalizations.delegate,
  ],
  supportedLocales: [
    Locale('en'),
    Locale('fr'),
    Locale('de'),
    Locale('es'),
    Locale('pt'),
    Locale('it'),
    Locale('ja'),
    Locale('ko'),
    Locale('zh'),
    Locale('tr'),
  ],
  locale: ref.watch(localeProvider),
)
```

## Fichiers Ã  modifier

### Haute prioritÃ© (beaucoup de texte)

1. `lib/features/auth/presentation/login_screen.dart`
2. `lib/features/auth/presentation/register_screen.dart`
3. `lib/features/dashboard/presentation/dashboard_screen.dart`
4. `lib/features/apps/presentation/apps_list_screen.dart`
5. `lib/features/apps/presentation/add_app_screen.dart`
6. `lib/features/settings/presentation/settings_screen.dart`
7. `lib/features/insights/presentation/app_insights_screen.dart`
8. `lib/features/insights/presentation/insights_compare_screen.dart`

### PrioritÃ© moyenne

9. `lib/features/keywords/presentation/keyword_search_screen.dart`
10. `lib/features/keywords/presentation/keyword_suggestions_modal.dart`
11. `lib/features/ratings/presentation/app_ratings_screen.dart`
12. `lib/shared/widgets/states.dart`
13. `lib/core/widgets/user_menu.dart`

## Extension helper (optionnel)

```dart
extension LocalizationExtension on BuildContext {
  AppLocalizations get l10n => AppLocalizations.of(this)!;
}

// Usage: context.l10n.auth_welcomeBack
```
